// Generated by CoffeeScript 1.3.3
(function() {
  var Login;

  Login = (function() {

    function Login(_arg) {
      var el,
        _this = this;
      el = _arg.el;
      this.el = $(el);
      this.selection = $(".chzn-select", this.el);
      if (localStorage.lastUsedOrgKey) {
        this.selectOrganisation(localStorage.lastUsedOrgKey);
        this.loginOnly();
      } else {
        this.organisationSelectionOnly();
      }
      this.selection.chosen({
        no_results_text: "Organisaatioita ei l√∂ydy sanalla: "
      });
      this.selection.change(function(e) {
        return _this.selectOrganisation(e.target.value);
      });
      $(".continue-button", this.el).click(function(e) {
        e.preventDefault();
        return _this.loginOnly();
      });
      $("a.change-organization", this.el).click(function(e) {
        e.preventDefault();
        return _this.organisationSelectionOnly();
      });
    }

    Login.prototype.selectOrganisation = function(orgKey) {
      var humanName;
      this.selection.val(orgKey);
      humanName = $("option[value=" + orgKey + "]").text();
      $(".org-container", this.el).text(humanName);
      return localStorage.lastUsedOrgKey = orgKey;
    };

    Login.prototype.organisationSelectionOnly = function() {
      this.el.addClass("organisation-only");
      return this.el.removeClass("login-only");
    };

    Login.prototype.loginOnly = function() {
      this.el.addClass("login-only");
      return this.el.removeClass("organisation-only");
    };

    return Login;

  })();

  $(function() {
    return window.login = new Login({
      el: $("body").get(0)
    });
  });

}).call(this);
